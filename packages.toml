# LFS Infrastructure - Package Definitions
# All packages use bleeding edge versions
# Set use_git = true to build from git HEAD instead of release tarball
#
# Build System Schema:
# ====================
# build_system = "autotools" | "meson" | "cmake" | "make" | "custom"
#   Default: "autotools" (./configure && make && make install)
#
# configure_flags = "--disable-foo --enable-bar"
#   Extra flags appended to ./configure (autotools only)
#
# meson_flags = "-Dfoo=false -Dbar=true"
#   Extra flags for meson setup (meson only)
#
# cmake_flags = "-DFOO=OFF -DBAR=ON"
#   Extra flags for cmake (cmake only)
#
# build_commands = ["cmd1", "cmd2", ...]
#   Full custom build commands (overrides build_system)
#   Variables: ${srcdir}, ${pkgdir}, ${version}, ${NPROC}
#
# provides = ["/usr/lib/libfoo.so", "/usr/bin/foo"]
#   Files to check for idempotency (skip build if all exist)
#
# Profile-Guided Optimization (PGO):
# ==================================
# Some packages support PGO for runtime performance gains (5-20%+).
# PGO builds use custom build_commands with this pattern:
#   1. Build with -fprofile-generate (instrumented)
#   2. Run representative workload (tests, benchmarks)
#   3. Rebuild with -fprofile-use -fprofile-correction (optimized)
#
# PGO-enabled packages in this file:
#   - gcc (profiledbootstrap): ~10% faster compilation
#   - python (--enable-optimizations): ~10% faster runtime
#   - llvm/clang (LLVM_BUILD_INSTRUMENTED): ~15-20% faster compilation
#   - zstd: ~5-10% faster compression
#   - sqlite: ~10-30% faster queries
#   - openssl: ~5% faster crypto operations
#
# Standard autotools packages need no extra fields - defaults work.

[settings]
lfs_version = "12.4+"
target_arch = "x86_64"

# =============================================================================
# STAGE 0: Bootstrap (pk is a shell script, no build needed)
# =============================================================================

# =============================================================================
# STAGE 1: Cross Toolchain
# =============================================================================

# Cross binutils for building cross-compiler (temporary)
# Build order: 1 (first in stage 1)
[packages.binutils-pass1]
version = "2.45.1"
version_check = "gnu:binutils"
description = "GNU binary utilities (cross-toolchain)"
source_pkg = "binutils"
stage = 1
build_order = 1
build_commands = [
    "mkdir -p build && cd build && ../configure --prefix=/var/tmp/lfs-bootstrap --with-sysroot=${SYSROOT} --target=${TARGET} --disable-nls --enable-gprofng=no --disable-werror --enable-new-dtags --enable-default-hash-style=gnu && make -j${NPROC} && make DESTDIR=${PKG} install"
]

# Final native binutils
[packages.binutils]
version = "2.45.1"
version_check = "gnu:binutils"
description = "GNU binary utilities"
url = "https://ftpmirror.gnu.org/gnu/binutils/binutils-${version}.tar.xz"
git_url = "git://sourceware.org/git/binutils-gdb.git"
use_git = false
checksum_url = "https://ftpmirror.gnu.org/gnu/binutils/binutils-${version}.tar.xz.sig"
stage = 3
build_commands = [
    "mkdir -p build && cd build",
    "../configure --prefix=/usr --sysconfdir=/etc --enable-gold --enable-ld=default --enable-plugins --enable-shared --disable-werror --enable-64-bit-bfd --enable-new-dtags --with-system-zlib --enable-default-hash-style=gnu",
    "make -j${NPROC} tooldir=/usr",
    "make DESTDIR=${PKG} tooldir=/usr install",
    "rm -fv ${PKG}/usr/lib/lib{bfd,ctf,ctf-nobfd,gprofng,opcodes,sframe}.a || true"
]

[packages.gcc]
version = "16-20260118"
version_check = "gcc-snapshot:"
description = "GNU Compiler Collection (development snapshot)"
url = "https://gcc.gnu.org/pub/gcc/snapshots/LATEST-16/gcc-${version}.tar.xz"
git_url = "git://gcc.gnu.org/git/gcc.git"
use_git = false
checksum_url = "https://gcc.gnu.org/pub/gcc/snapshots/LATEST-16/sha512.sum"
stage = 3
depends = ["gmp", "mpfr", "mpc"]
languages = "c,c++,fortran"
# PGO: profiledbootstrap compiles GCC 4 times with profile-guided optimization
# This takes longer but results in ~10% faster GCC
build_commands = [
    "case $(uname -m) in x86_64) sed -e '/m64=/s/lib64/lib/' -i.orig gcc/config/i386/t-linux64 ;; esac",
    "mkdir -p build && cd build && ../configure --prefix=/usr --enable-languages=c,c++,fortran --enable-default-pie --enable-default-ssp --disable-multilib --with-system-zlib --enable-plugin",
    "cd build && make -j${NPROC} profiledbootstrap",
    "cd build && make DESTDIR=${PKG} install",
    "ln -svf gcc ${PKG}/usr/bin/cc",
    "ln -svf ../bin/cpp ${PKG}/usr/lib/cpp",
    "ln -svf gcc.1 ${PKG}/usr/share/man/man1/cc.1"
]

# GCC Pass 1 - Cross compiler (limited, for building glibc)
# Build order: 2 (requires binutils-pass1)
[packages.gcc-pass1]
version = "16-20260118"
version_check = "gcc-snapshot:"
description = "GCC cross-compiler pass 1"
source_pkg = "gcc"
stage = 1
build_order = 2
depends = ["binutils-pass1"]
build_commands = [
    "tar -xf ${SOURCES}/mpfr-*.tar.xz && mv mpfr-* mpfr && tar -xf ${SOURCES}/gmp-*.tar.xz && mv gmp-* gmp && tar -xf ${SOURCES}/mpc-*.tar.* && mv mpc-* mpc",
    "case $(uname -m) in x86_64) sed -e '/m64=/s/lib64/lib/' -i.orig gcc/config/i386/t-linux64 ;; esac",
    "mkdir -p build && cd build && ../configure --target=${TARGET} --prefix=/var/tmp/lfs-bootstrap --with-glibc-version=2.42 --with-sysroot=${SYSROOT} --with-newlib --without-headers --enable-default-pie --enable-default-ssp --disable-nls --disable-shared --disable-multilib --disable-threads --disable-libatomic --disable-libgomp --disable-libquadmath --disable-libssp --disable-libvtv --disable-libstdcxx --enable-languages=c,c++ && make -j${NPROC} && make DESTDIR=${PKG} install && cat gcc/limitx.h gcc/glimits.h gcc/limity.h > $(dirname $(${PKG}/var/tmp/lfs-bootstrap/bin/${TARGET}-gcc -print-libgcc-file-name))/include/limits.h"
]

# Linux headers - can build in parallel with gcc-pass1
# Build order: 3 (no gcc dependency, but conventionally after)
[packages.linux-headers]
version = "6.18.7"
version_check = "kernel:"
description = "Linux kernel headers"
source_pkg = "linux"
stage = 1
build_order = 3
build_commands = [
    "make mrproper && make headers && find usr/include -type f ! -name '*.h' -delete && mkdir -p ${PKG}/usr/include && cp -rv usr/include/* ${PKG}/usr/include/"
]

# Glibc pass 1 - built with cross-compiler (temporary)
# Build order: 4 (requires gcc-pass1 + linux-headers)
[packages.glibc-pass1]
version = "2.42"
version_check = "gnu:glibc"
description = "GNU C Library (cross-built)"
source_pkg = "glibc"
stage = 1
build_order = 4
depends = ["gcc-pass1", "linux-headers"]
# LTO enabled (glibc 2.35+ supports it)
build_commands = [
    "mkdir -p build && cd build && echo 'rootsbindir=/usr/sbin' > configparms && ../configure --prefix=/usr --host=${TARGET} --build=$(../scripts/config.guess) --enable-kernel=5.4 --with-headers=${SYSROOT}/usr/include --disable-nscd libc_cv_slibdir=/usr/lib && make -j${NPROC} && make DESTDIR=${PKG} install",
    "case $(uname -m) in x86_64) mkdir -pv ${PKG}/lib64 && ln -sfv ../lib/ld-linux-x86-64.so.2 ${PKG}/lib64/ld-linux-x86-64.so.2 && ln -sfv ../lib/ld-linux-x86-64.so.2 ${PKG}/lib64/ld-lsb-x86-64.so.3 ;; esac",
    "sed '/RTLDLIST=/s@/usr@@g' -i ${PKG}/usr/bin/ldd"
]

# Final native glibc
[packages.glibc]
version = "2.42"
version_check = "gnu:glibc"
description = "GNU C Library"
url = "https://ftpmirror.gnu.org/gnu/glibc/glibc-${version}.tar.xz"
git_url = "git://sourceware.org/git/glibc.git"
use_git = false
checksum_url = "https://ftpmirror.gnu.org/gnu/glibc/glibc-${version}.tar.xz.sig"
stage = 3
# LTO enabled (glibc 2.35+ supports it)
build_commands = [
    "mkdir -p build && cd build",
    "echo 'rootsbindir=/usr/sbin' > configparms",
    "../configure --prefix=/usr --disable-werror --enable-kernel=5.4 --enable-stack-protector=strong --disable-nscd libc_cv_slibdir=/usr/lib",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install",
    "case $(uname -m) in x86_64) mkdir -pv ${PKG}/lib64 && ln -sfv ../lib/ld-linux-x86-64.so.2 ${PKG}/lib64/ld-linux-x86-64.so.2 && ln -sfv ../lib/ld-linux-x86-64.so.2 ${PKG}/lib64/ld-lsb-x86-64.so.3 ;; esac",
    "sed '/RTLDLIST=/s@/usr@@g' -i ${PKG}/usr/bin/ldd",
    "mkdir -pv ${PKG}/etc && cp -v ../nscd/nscd.conf ${PKG}/etc/nscd.conf"
]

# libstdc++ pass 1 - built with cross-compiler (temporary)
# Build order: 5 (requires glibc-pass1)
[packages.libstdcxx-pass1]
version = "16-20260118"
version_check = "gcc-snapshot:"
description = "GNU Standard C++ Library (cross-built)"
source_pkg = "gcc"
stage = 1
build_order = 5
depends = ["glibc-pass1"]
build_commands = [
    "mkdir -p build && cd build && CPP=cpp ../libstdc++-v3/configure --host=${TARGET} --build=$(../config.guess) --prefix=/usr --disable-multilib --disable-nls --disable-libstdcxx-pch --disable-libstdcxx-sdt --with-gxx-include-dir=/var/tmp/lfs-bootstrap/${TARGET}/include/c++/16.0.1 && make -j${NPROC} && make DESTDIR=${PKG} install && rm -fv ${PKG}/usr/lib/lib{stdc++{,exp,fs},supc++}.la"
]

# Final native libstdc++ (built as part of gcc, but can be built separately)
[packages.libstdcxx]
version = "16-20260118"
version_check = "gcc-snapshot:"
description = "GNU Standard C++ Library"
source_pkg = "gcc"
stage = 3
build_commands = [
    "mkdir -p build && cd build && ../libstdc++-v3/configure --prefix=/usr --disable-multilib --disable-nls --disable-libstdcxx-pch --with-gxx-include-dir=/usr/include/c++/16.0.1 && make -j${NPROC} && make DESTDIR=${PKG} install",
    "rm -fv ${PKG}/usr/lib/lib{stdc++{,exp,fs},supc++}.la || true"
]

# =============================================================================
# STAGE 2: Temporary Tools
# =============================================================================

# GCC Pass 2 - Full cross compiler
[packages.gcc-pass2]
version = "16-20260118"
version_check = "gcc-snapshot:"
description = "GCC cross-compiler pass 2"
source_pkg = "gcc"
stage = 2
provides = ["${SYSROOT}/usr/bin/cc"]
build_commands = [
    "tar -xf ${SOURCES}/mpfr-*.tar.xz && mv mpfr-* mpfr",
    "tar -xf ${SOURCES}/gmp-*.tar.xz && mv gmp-* gmp",
    "tar -xf ${SOURCES}/mpc-*.tar.* && mv mpc-* mpc",
    "case $(uname -m) in x86_64) sed -e '/m64=/s/lib64/lib/' -i.orig gcc/config/i386/t-linux64 ;; esac",
    "mkdir -p build && cd build && ../configure --build=$(../config.guess) --host=${TARGET} --target=${TARGET} LDFLAGS_FOR_TARGET=-L${PWD}/${TARGET}/libgcc --prefix=/usr --with-build-sysroot=${SYSROOT} --enable-default-pie --enable-default-ssp --disable-nls --disable-multilib --disable-libatomic --disable-libgomp --disable-libquadmath --disable-libsanitizer --disable-libssp --disable-libvtv --enable-languages=c,c++ && make -j${NPROC} && make DESTDIR=${PKG} install",
    "ln -sv gcc ${PKG}/usr/bin/cc"
]

[packages.m4]
version = "1.4.20"
version_check = "gnu:m4"
description = "GNU macro processor"
url = "https://ftpmirror.gnu.org/gnu/m4/m4-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/m4.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/m4"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(build-aux/config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.ncurses]
version = "6.6"
version_check = "gnu:ncurses"
description = "Terminal handling library"
url = "https://ftpmirror.gnu.org/gnu/ncurses/ncurses-${version}.tar.gz"
git_url = "https://github.com/mirror/ncurses.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/lib/libncursesw.so"]
build_commands = [
    "mkdir -p build && pushd build && ../configure AWK=gawk && make -C include && make -C progs tic && popd",
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess) --mandir=/usr/share/man --with-manpage-format=normal --with-shared --without-normal --without-cxx-binding --without-debug --without-ada --disable-stripping",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} TIC_PATH=$(pwd)/build/progs/tic install",
    "ln -svf libncursesw.so ${PKG}/usr/lib/libncurses.so",
    "sed -e 's/^#if.*XOPEN.*$/#if 1/' -i ${PKG}/usr/include/curses.h"
]

[packages.bash]
version = "5.3"
version_check = "gnu:bash"
description = "GNU Bourne-Again Shell"
url = "https://ftpmirror.gnu.org/gnu/bash/bash-${version}.tar.gz"
git_url = "https://git.savannah.gnu.org/git/bash.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/bash"]
build_commands = [
    "./configure --prefix=/usr --build=$(sh support/config.guess) --host=${TARGET} --without-bash-malloc bash_cv_strtold_broken=no",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install",
    "ln -svf bash ${PKG}/usr/bin/sh"
]

[packages.coreutils]
version = "9.9"
version_check = "gnu:coreutils"
description = "GNU core utilities"
url = "https://ftpmirror.gnu.org/gnu/coreutils/coreutils-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/coreutils.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/ls"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(build-aux/config.guess) --enable-install-program=hostname",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install",
    "mv -v ${PKG}/usr/bin/chroot ${PKG}/usr/sbin"
]

[packages.diffutils]
version = "3.12"
version_check = "gnu:diffutils"
description = "GNU diff utilities"
url = "https://ftpmirror.gnu.org/gnu/diffutils/diffutils-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/diffutils.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/diff"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess) gl_cv_func_strcasecmp_works=yes",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.file]
version = "5.46"
version_check = "url:https://github.com/file/file/tags|FILE([0-9]+)_([0-9]+)"
description = "File type identification"
url = "https://astron.com/pub/file/file-${version}.tar.gz"
git_url = "https://github.com/file/file.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/file"]
build_commands = [
    "mkdir -p build && pushd build && ../configure --disable-bzlib --disable-libseccomp --disable-xzlib --disable-zlib && make && popd",
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess)",
    "make FILE_COMPILE=$(pwd)/build/src/file -j${NPROC}",
    "make DESTDIR=${PKG} install",
    "rm -v ${PKG}/usr/lib/libmagic.la"
]

[packages.findutils]
version = "4.10.0"
version_check = "gnu:findutils"
description = "GNU find utilities"
url = "https://ftpmirror.gnu.org/gnu/findutils/findutils-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/findutils.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/find"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess) --localstatedir=/var/lib/locate gl_cv_func_wcwidth_works=yes",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.gawk]
version = "5.3.2"
version_check = "gnu:gawk"
description = "GNU AWK"
url = "https://ftpmirror.gnu.org/gnu/gawk/gawk-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/gawk.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/gawk"]
build_commands = [
    "sed -i 's/extras//' Makefile.in",
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.grep]
version = "3.12"
version_check = "gnu:grep"
description = "GNU grep"
url = "https://ftpmirror.gnu.org/gnu/grep/grep-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/grep.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/grep"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.gzip]
version = "1.14"
version_check = "gnu:gzip"
description = "GNU compression utility"
url = "https://ftpmirror.gnu.org/gnu/gzip/gzip-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/gzip.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/gzip"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.make]
version = "4.4.1"
version_check = "gnu:make"
description = "GNU make"
url = "https://ftpmirror.gnu.org/gnu/make/make-${version}.tar.gz"
git_url = "https://git.savannah.gnu.org/git/make.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/make"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(build-aux/config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.patch]
version = "2.8"
version_check = "gnu:patch"
description = "GNU patch"
url = "https://ftpmirror.gnu.org/gnu/patch/patch-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/patch.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/patch"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.sed]
version = "4.9"
version_check = "gnu:sed"
description = "GNU stream editor"
url = "https://ftpmirror.gnu.org/gnu/sed/sed-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/sed.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/sed"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.tar]
version = "1.35"
version_check = "gnu:tar"
description = "GNU tar"
url = "https://ftpmirror.gnu.org/gnu/tar/tar-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/tar.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/tar"]
build_commands = [
    "FORCE_UNSAFE_CONFIGURE=1 ./configure --prefix=/usr --host=${TARGET} --build=$(build-aux/config.guess)",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.xz]
version = "5.8.2"
version_check = "tukaani:xz"
description = "XZ compression utilities"
url = "https://github.com/tukaani-project/xz/releases/download/v${version}/xz-${version}.tar.xz"
git_url = "https://github.com/tukaani-project/xz.git"
use_git = false
stage = 2
provides = ["${SYSROOT}/usr/bin/xz"]
build_commands = [
    "./configure --prefix=/usr --host=${TARGET} --build=$(./config.guess) --disable-static --docdir=/usr/share/doc/xz-${version}",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install",
    "rm -v ${PKG}/usr/lib/liblzma.la"
]

# Binutils Pass 2 - Cross binutils for temp tools (after glibc)
[packages.binutils-pass2]
version = "2.45.1"
version_check = "gnu:binutils"
description = "GNU binary utilities pass 2"
source_pkg = "binutils"
stage = 2
provides = ["${SYSROOT}/usr/bin/ld"]
build_commands = [
    "mkdir -p build && cd build && ../configure --prefix=/usr --build=$(../config.guess) --host=${TARGET} --disable-nls --enable-shared --enable-gprofng=no --disable-werror --enable-64-bit-bfd --enable-new-dtags --enable-default-hash-style=gnu && make -j${NPROC} && make DESTDIR=${PKG} install",
    "rm -v ${PKG}/usr/lib/lib{bfd,ctf,ctf-nobfd,opcodes,sframe}.{a,la}"
]

# =============================================================================
# STAGE 3: Basic System Software
# =============================================================================

[packages.zlib]
version = "1.3.1"
version_check = "zlib:"
description = "Compression library"
url = "https://zlib.net/zlib-${version}.tar.xz"
git_url = "https://github.com/madler/zlib.git"
use_git = false
stage = 3

[packages.bzip2]
version = "1.0.8"
version_check = "sourceware:bzip2"
description = "Block-sorting compression"
url = "https://sourceware.org/pub/bzip2/bzip2-${version}.tar.gz"
git_url = "https://gitlab.com/bzip2/bzip2.git"
use_git = false
stage = 3

[packages.zstd]
version = "1.5.7"
version_check = "github:facebook/zstd"
description = "Zstandard compression"
url = "https://github.com/facebook/zstd/releases/download/v${version}/zstd-${version}.tar.gz"
git_url = "https://github.com/facebook/zstd.git"
use_git = false
stage = 3
# PGO: Build with profiling, run benchmarks, rebuild with profile data
# Results in ~5-10% faster compression/decompression
build_commands = [
    "make -j${NPROC} CFLAGS=\"${CFLAGS} -fprofile-generate\" LDFLAGS=\"${LDFLAGS} -fprofile-generate\" lib-mt",
    "make -j${NPROC} CFLAGS=\"${CFLAGS} -fprofile-generate\" LDFLAGS=\"${LDFLAGS} -fprofile-generate\" zstd",
    "./zstd -b1 -e19 -i5",
    "make clean",
    "make -j${NPROC} CFLAGS=\"${CFLAGS} -fprofile-use -fprofile-correction\" LDFLAGS=\"${LDFLAGS}\" lib-mt",
    "make -j${NPROC} CFLAGS=\"${CFLAGS} -fprofile-use -fprofile-correction\" LDFLAGS=\"${LDFLAGS}\" zstd",
    "make PREFIX=/usr DESTDIR=${PKG} install"
]

[packages.readline]
version = "8.3"
version_check = "gnu:readline"
description = "GNU readline library"
url = "https://ftpmirror.gnu.org/gnu/readline/readline-${version}.tar.gz"
git_url = "https://git.savannah.gnu.org/git/readline.git"
use_git = false
stage = 3

[packages.sqlite]
version = "3.48.0"
version_check = "url:https://www.sqlite.org/download.html|sqlite-autoconf-([0-9]+)"
description = "Self-contained SQL database engine"
url = "https://www.sqlite.org/2025/sqlite-autoconf-3480000.tar.gz"
git_url = "https://github.com/sqlite/sqlite.git"
use_git = false
stage = 3
# PGO: SQLite benefits significantly from PGO (~10-30% gains)
# Build instrumented, run speedtest1 benchmark, rebuild with profile data
build_commands = [
    "./configure --prefix=/usr --enable-fts5 --enable-json1 CFLAGS=\"${CFLAGS} -fprofile-generate\" LDFLAGS=\"${LDFLAGS} -fprofile-generate\"",
    "make -j${NPROC}",
    "gcc -O2 -I. test/speedtest1.c .libs/libsqlite3.a -lpthread -ldl -lm -o speedtest1 -fprofile-generate || true",
    "./speedtest1 --size 50 || ./sqlite3 ':memory:' 'SELECT * FROM sqlite_master;' || true",
    "make clean",
    "./configure --prefix=/usr --enable-fts5 --enable-json1 CFLAGS=\"${CFLAGS} -fprofile-use -fprofile-correction\" LDFLAGS=\"${LDFLAGS}\"",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]
provides = ["/usr/lib/libsqlite3.so", "/usr/bin/sqlite3"]

[packages.bc]
version = "7.0.3"
version_check = "gnu:bc"
description = "Arbitrary precision calculator"
url = "https://github.com/gavinhoward/bc/releases/download/${version}/bc-${version}.tar.xz"
git_url = "https://github.com/gavinhoward/bc.git"
use_git = false
stage = 3

[packages.flex]
version = "2.6.4"
version_check = "github:westes/flex"
description = "Fast lexical analyzer generator"
url = "https://github.com/westes/flex/releases/download/v${version}/flex-${version}.tar.gz"
git_url = "https://github.com/westes/flex.git"
use_git = false
stage = 3

[packages.gettext]
version = "0.26"
version_check = "gnu:gettext"
description = "GNU internationalization"
url = "https://ftpmirror.gnu.org/gnu/gettext/gettext-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/gettext.git"
use_git = false
stage = 3

[packages.bison]
version = "3.8.2"
version_check = "gnu:bison"
description = "GNU parser generator"
url = "https://ftpmirror.gnu.org/gnu/bison/bison-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/bison.git"
use_git = false
stage = 3

[packages.perl]
version = "5.42.0"
version_check = "cpan:perl"
description = "Practical Extraction and Report Language"
url = "https://www.cpan.org/src/5.0/perl-${version}.tar.xz"
git_url = "https://github.com/Perl/perl5.git"
use_git = false
stage = 3

[packages.python]
version = "3.14.2"
version_check = "python:"
description = "Python programming language"
url = "https://www.python.org/ftp/python/${version}/Python-${version}.tar.xz"
git_url = "https://github.com/python/cpython.git"
use_git = false
stage = 3
build_commands = [
    "./configure --prefix=/usr --enable-shared --enable-optimizations --with-lto --with-system-expat --with-system-ffi --with-ensurepip=install",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install",
    "ln -sf python3 ${PKG}/usr/bin/python",
    "ln -sf pip3 ${PKG}/usr/bin/pip"
]

[packages.texinfo]
version = "7.2"
version_check = "gnu:texinfo"
description = "GNU documentation system"
url = "https://ftpmirror.gnu.org/gnu/texinfo/texinfo-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/texinfo.git"
use_git = false
stage = 3

[packages.util-linux]
version = "2.40.2"
version_check = "github:util-linux/util-linux"
description = "Linux system utilities"
url = "https://www.kernel.org/pub/linux/utils/util-linux/v2.40/util-linux-${version}.tar.xz"
git_url = "https://github.com/util-linux/util-linux.git"
use_git = false
stage = 3

[packages.acl]
version = "2.3.2"
version_check = "savannah:acl"
description = "Access Control Lists"
url = "https://download.savannah.nongnu.org/releases/acl/acl-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/acl.git"
use_git = false
stage = 3

[packages.attr]
version = "2.5.2"
version_check = "savannah:attr"
description = "Extended filesystem attributes"
url = "https://download.savannah.nongnu.org/releases/attr/attr-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/attr.git"
use_git = false
stage = 3

[packages.shadow]
version = "4.19.2"
version_check = "github:shadow-maint/shadow"
description = "Password and shadow file utilities"
url = "https://github.com/shadow-maint/shadow/releases/download/${version}/shadow-${version}.tar.xz"
git_url = "https://github.com/shadow-maint/shadow.git"
use_git = false
stage = 3

[packages.libmd]
version = "1.1.0"
version_check = "url:https://libbsd.freedesktop.org/releases/|libmd-[0-9]+\.[0-9]+(\.[0-9]+)?\.tar"
description = "Message digest functions from BSD"
url = "https://libbsd.freedesktop.org/releases/libmd-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/libbsd/libmd.git"
use_git = false
stage = 3

[packages.libbsd]
version = "0.12.2"
version_check = "url:https://libbsd.freedesktop.org/releases/|libbsd-[0-9]+\.[0-9]+(\.[0-9]+)?\.tar"
description = "BSD portability library"
url = "https://libbsd.freedesktop.org/releases/libbsd-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/libbsd/libbsd.git"
use_git = false
stage = 3
depends = ["libmd"]

[packages.procps-ng]
version = "4.0.4"
version_check = "github:procps-ng/procps"
description = "Process monitoring utilities (ps, top, pgrep)"
url = "https://sourceforge.net/projects/procps-ng/files/Production/procps-ng-${version}.tar.xz"
git_url = "https://gitlab.com/procps-ng/procps.git"
use_git = false
stage = 3

[packages.libtirpc]
version = "1.3.6"
version_check = "sourceforge:libtirpc"
description = "Transport-Independent RPC library"
url = "https://downloads.sourceforge.net/libtirpc/libtirpc-${version}.tar.bz2"
git_url = "https://git.linux-nfs.org/projects/steved/libtirpc.git"
use_git = false
stage = 3

[packages.iana-etc]
version = "20251215"
version_check = "url:https://github.com/Mic92/iana-etc/releases|/releases/tag/([0-9]+)"
description = "IANA /etc files (protocols, services)"
url = "https://github.com/Mic92/iana-etc/releases/download/${version}/iana-etc-${version}.tar.gz"
git_url = "https://github.com/Mic92/iana-etc.git"
use_git = false
stage = 3

# =============================================================================
# STAGE 4: System Configuration & Security
# =============================================================================

[packages.openssl]
version = "3.6.0-beta1"
version_check = "github:openssl/openssl"
description = "TLS/SSL and crypto library"
url = "https://github.com/openssl/openssl/releases/download/openssl-${version}/openssl-${version}.tar.gz"
git_url = "https://github.com/openssl/openssl.git"
use_git = false
stage = 4
# PGO: OpenSSL benefits ~5% from PGO using crypto benchmarks
# Build instrumented, run openssl speed benchmarks, rebuild with profile
build_commands = [
    "./Configure --prefix=/usr --openssldir=/etc/ssl --libdir=lib shared zlib-dynamic enable-ktls linux-x86_64 -fprofile-generate",
    "make -j${NPROC}",
    "./apps/openssl speed -seconds 3 rsa2048 aes-256-cbc sha256 || true",
    "./apps/openssl speed -seconds 3 -evp aes-256-gcm sha512 || true",
    "make clean",
    "./Configure --prefix=/usr --openssldir=/etc/ssl --libdir=lib shared zlib-dynamic enable-ktls linux-x86_64 -fprofile-use -fprofile-correction",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]
provides = ["/usr/lib/libssl.so", "/usr/lib/libcrypto.so"]

[packages.nettle]
version = "3.10.2"
version_check = "gnu:nettle"
description = "Low-level cryptographic library"
url = "https://ftpmirror.gnu.org/gnu/nettle/nettle-${version}.tar.gz"
git_url = "https://git.lysator.liu.se/nettle/nettle.git"
use_git = false
stage = 4
configure_flags = "--disable-static"
provides = ["/usr/lib/libnettle.so", "/usr/lib/libhogweed.so"]
depends = ["gmp"]

[packages.libtasn1]
version = "4.21.0"
version_check = "gnu:libtasn1"
description = "ASN.1 library"
url = "https://ftpmirror.gnu.org/gnu/libtasn1/libtasn1-${version}.tar.gz"
git_url = "https://gitlab.com/gnutls/libtasn1.git"
use_git = false
stage = 4
configure_flags = "--disable-static"
provides = ["/usr/lib/libtasn1.so"]

[packages.libunistring]
version = "1.4.1"
version_check = "gnu:libunistring"
description = "Unicode string library"
url = "https://ftpmirror.gnu.org/gnu/libunistring/libunistring-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/libunistring.git"
use_git = false
stage = 4
configure_flags = "--disable-static"
provides = ["/usr/lib/libunistring.so"]

[packages.gnutls]
version = "3.8.11"
version_check = "github:gnutls/gnutls"
description = "TLS library"
url = "https://www.gnupg.org/ftp/gcrypt/gnutls/v3.8/gnutls-${version}.tar.xz"
git_url = "https://gitlab.com/gnutls/gnutls.git"
use_git = false
stage = 4
configure_flags = "--disable-static --without-p11-kit --with-default-trust-store-file=/etc/ssl/certs/ca-certificates.crt --disable-doc --disable-tests --disable-libdane"
provides = ["/usr/lib/libgnutls.so"]
depends = ["nettle", "libtasn1", "libunistring", "gmp"]

[packages.libffi]
version = "3.5.2"
version_check = "github:libffi/libffi"
description = "Foreign function interface library"
url = "https://github.com/libffi/libffi/releases/download/v${version}/libffi-${version}.tar.gz"
git_url = "https://github.com/libffi/libffi.git"
use_git = false
stage = 4

[packages.expat]
version = "2.7.3"
version_check = "github:libexpat/libexpat"
description = "XML parser library"
url = "https://github.com/libexpat/libexpat/releases/download/R_2_7_3/expat-${version}.tar.xz"
git_url = "https://github.com/libexpat/libexpat.git"
use_git = false
stage = 4

[packages.autoconf]
version = "2.72"
version_check = "gnu:autoconf"
description = "GNU autoconf"
url = "https://ftpmirror.gnu.org/gnu/autoconf/autoconf-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/autoconf.git"
use_git = false
stage = 4

[packages.automake]
version = "1.18.1"
version_check = "gnu:automake"
description = "GNU automake"
url = "https://ftpmirror.gnu.org/gnu/automake/automake-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/automake.git"
use_git = false
stage = 4

[packages.libtool]
version = "2.5.4"
version_check = "gnu:libtool"
description = "GNU libtool"
url = "https://ftpmirror.gnu.org/gnu/libtool/libtool-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/libtool.git"
use_git = false
stage = 4

[packages.pkgconf]
version = "2.5.1"
version_check = "github:pkgconf/pkgconf"
description = "Package compiler and linker metadata toolkit"
url = "https://distfiles.ariadne.space/pkgconf/pkgconf-${version}.tar.xz"
git_url = "https://github.com/pkgconf/pkgconf.git"
use_git = false
stage = 4

[packages.ninja]
version = "1.13.2"
version_check = "github:ninja-build/ninja"
description = "Small build system with focus on speed"
url = "https://github.com/ninja-build/ninja/archive/refs/tags/v${version}.tar.gz"
git_url = "https://github.com/ninja-build/ninja.git"
use_git = false
stage = 4
build_system = "custom"
build_commands = ["python3 configure.py --bootstrap", "install -m755 ninja /usr/bin/"]
provides = ["/usr/bin/ninja"]

[packages.meson]
version = "1.10.1"
version_check = "github:mesonbuild/meson"
description = "Fast and user-friendly build system"
url = "https://github.com/mesonbuild/meson/releases/download/${version}/meson-${version}.tar.gz"
git_url = "https://github.com/mesonbuild/meson.git"
use_git = false
stage = 4
build_system = "custom"
build_commands = ["pip3 install --root=/ --prefix=/usr --no-deps ."]
provides = ["/usr/bin/meson"]
depends = ["python", "ninja"]

# =============================================================================
# STAGE 5: Kernel and Bootloader
# =============================================================================

[packages.linux]
version = "6.18.7"
version_check = "kernel:"
description = "Linux kernel"
url = "https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-${version}.tar.xz"
git_url = "https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git"
use_git = false
checksum_url = "https://cdn.kernel.org/pub/linux/kernel/v6.x/sha256sums.asc"
stage = 5
build_system = "custom"
build_commands = ["make mrproper", "make defconfig", "make -j${NPROC}", "make modules_install", "cp arch/x86/boot/bzImage /boot/vmlinuz-${version}", "cp System.map /boot/System.map-${version}"]
provides = ["/boot/vmlinuz-${version}"]

[packages.grub]
version = "2.14"
version_check = "gnu:grub"
description = "GRand Unified Bootloader"
url = "https://ftpmirror.gnu.org/gnu/grub/grub-${version}.tar.xz"
git_url = "https://git.savannah.gnu.org/git/grub.git"
use_git = false
stage = 5

[packages.efibootmgr]
version = "18"
version_check = "github:rhboot/efibootmgr"
description = "EFI Boot Manager utility"
url = "https://github.com/rhboot/efibootmgr/releases/download/${version}/efibootmgr-${version}.tar.bz2"
git_url = "https://github.com/rhboot/efibootmgr.git"
use_git = false
stage = 5

[packages.efivar]
version = "38"
version_check = "github:rhboot/efivar"
description = "EFI variable manipulation library"
url = "https://github.com/rhboot/efivar/archive/refs/tags/${version}.tar.gz"
git_url = "https://github.com/rhboot/efivar.git"
use_git = false
stage = 5

# =============================================================================
# GCC Support Libraries (built before GCC)
# =============================================================================

# GCC support libraries - needed for final GCC build (stage 3)
# Note: gcc-pass1/pass2 extract these from tarballs directly
[packages.gmp]
version = "6.3.0"
version_check = "gnu:gmp"
description = "GNU Multiple Precision Arithmetic Library"
url = "https://ftpmirror.gnu.org/gnu/gmp/gmp-${version}.tar.xz"
git_url = "https://gmplib.org/repo/gmp/"
use_git = false
stage = 3
configure_flags = "--enable-cxx"
provides = ["/usr/lib/libgmp.so"]

[packages.mpfr]
version = "4.2.2"
version_check = "gnu:mpfr"
description = "GNU Multiple Precision Floating-Point Reliable Library"
url = "https://ftpmirror.gnu.org/gnu/mpfr/mpfr-${version}.tar.xz"
git_url = "https://gitlab.inria.fr/mpfr/mpfr.git"
use_git = false
stage = 3
depends = ["gmp"]

[packages.mpc]
version = "1.3.1"
version_check = "gnu:mpc"
description = "GNU Multiple Precision Complex Library"
url = "https://ftpmirror.gnu.org/gnu/mpc/mpc-${version}.tar.gz"
git_url = "https://gitlab.inria.fr/mpc/mpc.git"
use_git = false
stage = 3
depends = ["gmp", "mpfr"]

[packages.isl]
version = "0.27"
version_check = "url:https://libisl.sourceforge.io/|isl-[0-9]+\.[0-9]+(\.[0-9]+)?\.tar"
description = "Integer Set Library"
url = "https://libisl.sourceforge.io/isl-${version}.tar.xz"
git_url = "https://repo.or.cz/isl.git"
use_git = false
stage = 3
depends = ["gmp"]

# =============================================================================
# STAGE 4 ADDITIONS: Build Tools
# =============================================================================

[packages.cmake]
version = "4.2.2"
version_check = "github:Kitware/CMake"
description = "Cross-platform build system generator"
url = "https://github.com/Kitware/CMake/releases/download/v${version}/cmake-${version}.tar.gz"
git_url = "https://github.com/Kitware/CMake.git"
use_git = false
stage = 4
build_system = "custom"
build_commands = ["./bootstrap --prefix=/usr --parallel=${NPROC}", "make -j${NPROC}", "make install"]
provides = ["/usr/bin/cmake"]

[packages.sudo]
version = "1.9.17p2"
version_check = "url:https://www.sudo.ws/releases/stable/|sudo-([0-9]+\.[0-9]+[p0-9]*)\.tar"
description = "Execute commands as another user"
url = "https://www.sudo.ws/dist/sudo-${version}.tar.gz"
git_url = "https://github.com/sudo-project/sudo.git"
use_git = false
stage = 4
configure_flags = "--with-all-insults --with-env-editor --with-passprompt=[sudo] password for %p:"
provides = ["/usr/bin/sudo"]

# =============================================================================
# STAGE 6: Init System (runit for fast boot)
# =============================================================================

[packages.runit]
version = "2.3.0"
version_check = "url:http://smarden.org/runit/|runit-([0-9]+\.[0-9]+\.[0-9]+)\.tar"
description = "UNIX init scheme with service supervision"
url = "http://smarden.org/runit/runit-${version}.tar.gz"
git_url = "https://github.com/void-linux/runit.git"
use_git = false
stage = 6

# =============================================================================
# STAGE 7: Networking
# =============================================================================

[packages.libnl]
version = "3.11.0"
version_check = "url:https://github.com/thom311/libnl/tags|libnl([0-9]+)_([0-9]+)_([0-9]+)"
description = "Netlink protocol library suite"
url = "https://github.com/thom311/libnl/releases/download/libnl3_11_0/libnl-${version}.tar.gz"
git_url = "https://github.com/thom311/libnl.git"
use_git = false
stage = 7

[packages.iwd]
version = "3.10"
version_check = "kernelorg:linux/network/wireless|iwd"
description = "Intel wireless daemon"
url = "https://www.kernel.org/pub/linux/network/wireless/iwd-${version}.tar.xz"
git_url = "https://git.kernel.org/pub/scm/network/wireless/iwd.git"
use_git = false
stage = 7

[packages.wpa_supplicant]
version = "2.11"
version_check = "url:https://w1.fi/releases/|wpa_supplicant-[0-9]+\.[0-9]+(\.[0-9]+)?\.tar"
description = "WPA/WPA2/WPA3 supplicant"
url = "https://w1.fi/releases/wpa_supplicant-${version}.tar.gz"
git_url = "https://w1.fi/cgit/hostap/"
use_git = false
stage = 7

[packages.wireless-tools]
version = "29"
version_check = "url:https://hewlettpackard.github.io/wireless-tools/|wireless_tools\.([0-9]+)\.tar"
description = "Wireless LAN tools"
url = "https://hewlettpackard.github.io/wireless-tools/wireless_tools.${version}.tar.gz"
git_url = ""
use_git = false
stage = 7

[packages.dhcpcd]
version = "10.3.0"
version_check = "github:NetworkConfiguration/dhcpcd"
description = "DHCP client daemon"
url = "https://github.com/NetworkConfiguration/dhcpcd/releases/download/v${version}/dhcpcd-${version}.tar.xz"
git_url = "https://github.com/NetworkConfiguration/dhcpcd.git"
use_git = false
stage = 7

[packages.cronie]
version = "1.7.2"
version_check = "github:cronie-crond/cronie"
description = "Cron daemon"
url = "https://github.com/cronie-crond/cronie/releases/download/cronie-${version}/cronie-${version}.tar.gz"
git_url = "https://github.com/cronie-crond/cronie.git"
use_git = false
stage = 7

[packages.rsync]
version = "3.4.1"
version_check = "url:https://rsync.samba.org/|rsync-([0-9]+\\.[0-9]+\\.[0-9]+)"
description = "Fast incremental file transfer"
url = "https://rsync.samba.org/ftp/rsync/src/rsync-${version}.tar.gz"
git_url = "https://github.com/WayneD/rsync.git"
use_git = false
stage = 7
build_commands = [
    "./configure --prefix=/usr --disable-debug --with-included-zlib=no --with-included-popt=no",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.rsnapshot]
version = "1.5.1"
version_check = "github:rsnapshot/rsnapshot"
description = "Filesystem snapshot utility based on rsync"
url = "https://github.com/rsnapshot/rsnapshot/releases/download/${version}/rsnapshot-${version}.tar.gz"
git_url = "https://github.com/rsnapshot/rsnapshot.git"
use_git = false
stage = 7
depends = ["rsync", "perl"]
build_commands = [
    "./configure --prefix=/usr --sysconfdir=/etc",
    "make -j${NPROC}",
    "make DESTDIR=${PKG} install"
]

[packages.curl]
version = "8.18.0"
version_check = "github:curl/curl"
description = "URL transfer library and tool"
url = "https://curl.se/download/curl-${version}.tar.xz"
git_url = "https://github.com/curl/curl.git"
use_git = false
stage = 7

[packages.wget]
version = "1.24.5"
version_check = "gnu:wget"
description = "Network downloader"
url = "https://ftpmirror.gnu.org/gnu/wget/wget-${version}.tar.gz"
git_url = "https://git.savannah.gnu.org/git/wget.git"
use_git = false
stage = 7

# =============================================================================
# STAGE 8: X11/Xorg
# =============================================================================

[packages.xorg-server]
version = "21.1.21"
version_check = "xorg:xserver/xorg-server"
description = "X.Org X11 server"
url = "https://www.x.org/releases/individual/xserver/xorg-server-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/xserver.git"
use_git = false
stage = 8

[packages.libX11]
version = "1.8.12"
version_check = "xorg:lib/libX11"
description = "X11 client library"
url = "https://www.x.org/releases/individual/lib/libX11-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libx11.git"
use_git = false
stage = 8

[packages.libXft]
version = "2.3.9"
version_check = "xorg:lib/libXft"
description = "X FreeType library"
url = "https://www.x.org/releases/individual/lib/libXft-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxft.git"
use_git = false
stage = 8

[packages.libXrender]
version = "0.9.12"
version_check = "xorg:lib/libXrender"
description = "X Render extension library"
url = "https://www.x.org/releases/individual/lib/libXrender-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxrender.git"
use_git = false
stage = 8

[packages.libXrandr]
version = "1.5.4"
version_check = "xorg:lib/libXrandr"
description = "X RandR extension library"
url = "https://www.x.org/releases/individual/lib/libXrandr-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxrandr.git"
use_git = false
stage = 8

[packages.libXinerama]
version = "1.1.5"
version_check = "xorg:lib/libXinerama"
description = "X Xinerama extension library"
url = "https://www.x.org/releases/individual/lib/libXinerama-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxinerama.git"
use_git = false
stage = 8

[packages.libXcursor]
version = "1.2.3"
version_check = "xorg:lib/libXcursor"
description = "X cursor management library"
url = "https://www.x.org/releases/individual/lib/libXcursor-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxcursor.git"
use_git = false
stage = 8

[packages.libXi]
version = "1.8.2"
version_check = "xorg:lib/libXi"
description = "X Input extension library"
url = "https://www.x.org/releases/individual/lib/libXi-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxi.git"
use_git = false
stage = 8

[packages.libXext]
version = "1.3.6"
version_check = "xorg:lib/libXext"
description = "X extension library"
url = "https://www.x.org/releases/individual/lib/libXext-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxext.git"
use_git = false
stage = 8

[packages.libXcomposite]
version = "0.4.6"
version_check = "xorg:lib/libXcomposite"
description = "X Composite extension library"
url = "https://www.x.org/releases/individual/lib/libXcomposite-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxcomposite.git"
use_git = false
stage = 8

[packages.libXdamage]
version = "1.1.6"
version_check = "xorg:lib/libXdamage"
description = "X Damage extension library"
url = "https://www.x.org/releases/individual/lib/libXdamage-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxdamage.git"
use_git = false
stage = 8

[packages.libXfixes]
version = "6.0.2"
version_check = "xorg:lib/libXfixes"
description = "X Fixes extension library"
url = "https://www.x.org/releases/individual/lib/libXfixes-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxfixes.git"
use_git = false
stage = 8

[packages.xorgproto]
version = "2025.1"
version_check = "freedesktop:xorg/proto/xorgproto"
description = "X.Org protocol headers"
url = "https://xorg.freedesktop.org/archive/individual/proto/xorgproto-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/proto/xorgproto.git"
use_git = false
stage = 8

[packages.xcb-proto]
version = "1.17.0"
version_check = "freedesktop:xorg/proto/xcbproto"
description = "XCB protocol descriptions"
url = "https://xorg.freedesktop.org/archive/individual/proto/xcb-proto-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/proto/xcbproto.git"
use_git = false
stage = 8

[packages.libxcb]
version = "1.17.0"
version_check = "freedesktop:xorg/lib/libxcb"
description = "X C Binding library"
url = "https://xorg.freedesktop.org/archive/individual/lib/libxcb-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxcb.git"
use_git = false
stage = 8

[packages.pixman]
version = "0.46.4"
version_check = "freedesktop:pixman/pixman"
description = "Pixel manipulation library"
url = "https://www.cairographics.org/releases/pixman-${version}.tar.gz"
git_url = "https://gitlab.freedesktop.org/pixman/pixman.git"
use_git = false
stage = 8

[packages.freetype]
version = "2.14.1"
version_check = "savannah:freetype"
description = "Font rendering library"
url = "https://downloads.sourceforge.net/freetype/freetype-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/freetype/freetype.git"
use_git = false
stage = 8

[packages.fontconfig]
version = "2.16.0"
version_check = "freedesktop:fontconfig/fontconfig"
description = "Font configuration library"
url = "https://www.freedesktop.org/software/fontconfig/release/fontconfig-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/fontconfig/fontconfig.git"
use_git = false
stage = 8

[packages.libpng]
version = "1.6.54"
version_check = "github:pnggroup/libpng"
description = "PNG image library"
url = "https://downloads.sourceforge.net/libpng/libpng-${version}.tar.xz"
git_url = "https://github.com/pnggroup/libpng.git"
use_git = false
stage = 8

[packages.libjpeg-turbo]
version = "3.1.3"
version_check = "github:libjpeg-turbo/libjpeg-turbo"
description = "JPEG image library with SIMD acceleration"
url = "https://github.com/libjpeg-turbo/libjpeg-turbo/releases/download/${version}/libjpeg-turbo-${version}.tar.gz"
git_url = "https://github.com/libjpeg-turbo/libjpeg-turbo.git"
use_git = false
stage = 8

[packages.mesa]
version = "24.3.4"
version_check = "freedesktop:mesa/mesa"
description = "OpenGL implementation"
url = "https://mesa.freedesktop.org/archive/mesa-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/mesa/mesa.git"
use_git = false
stage = 8

[packages.libdrm]
version = "2.4.131"
version_check = "freedesktop:mesa/drm"
description = "Direct Rendering Manager library"
url = "https://dri.freedesktop.org/libdrm/libdrm-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/mesa/drm.git"
use_git = false
stage = 8

[packages.libXdmcp]
version = "1.1.5"
version_check = "xorg:lib/libXdmcp"
description = "X Display Manager Control Protocol library"
url = "https://www.x.org/releases/individual/lib/libXdmcp-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxdmcp.git"
use_git = false
stage = 8

[packages.libglvnd]
version = "1.7.0"
version_check = "github:NVIDIA/libglvnd"
description = "GL Vendor-Neutral Dispatch library"
url = "https://gitlab.freedesktop.org/glvnd/libglvnd/-/archive/v${version}/libglvnd-v${version}.tar.gz"
git_url = "https://gitlab.freedesktop.org/glvnd/libglvnd.git"
use_git = false
stage = 8

[packages.libepoxy]
version = "1.5.10"
version_check = "github:anholt/libepoxy"
description = "Library for handling OpenGL function pointer management"
url = "https://download.gnome.org/sources/libepoxy/1.5/libepoxy-${version}.tar.xz"
git_url = "https://github.com/anholt/libepoxy.git"
use_git = false
stage = 8

[packages.libinput]
version = "1.27.1"
version_check = "freedesktop:libinput/libinput"
description = "Input device handling library"
url = "https://gitlab.freedesktop.org/libinput/libinput/-/archive/${version}/libinput-${version}.tar.gz"
git_url = "https://gitlab.freedesktop.org/libinput/libinput.git"
use_git = false
stage = 8

[packages.libevdev]
version = "1.13.6"
version_check = "freedesktop:libevdev/libevdev"
description = "Event device library"
url = "https://www.freedesktop.org/software/libevdev/libevdev-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/libevdev/libevdev.git"
use_git = false
stage = 8

[packages.mtdev]
version = "1.1.7"
version_check = "github:nicwn/mtdev"
description = "Multitouch protocol translation library"
url = "https://bitmath.org/code/mtdev/mtdev-${version}.tar.bz2"
git_url = "https://bitmath.org/git/mtdev.git"
use_git = false
stage = 8

[packages.xf86-input-libinput]
version = "1.5.0"
version_check = "xorg:driver/xf86-input-libinput"
description = "Xorg libinput input driver"
url = "https://www.x.org/releases/individual/driver/xf86-input-libinput-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/driver/xf86-input-libinput.git"
use_git = false
stage = 8

[packages.xf86-video-fbdev]
version = "0.5.0"
version_check = "xorg:driver/xf86-video-fbdev"
description = "Xorg framebuffer video driver"
url = "https://www.x.org/releases/individual/driver/xf86-video-fbdev-${version}.tar.bz2"
git_url = "https://gitlab.freedesktop.org/xorg/driver/xf86-video-fbdev.git"
use_git = false
stage = 8

[packages.xf86-video-vesa]
version = "2.6.0"
version_check = "xorg:driver/xf86-video-vesa"
description = "Xorg VESA video driver"
url = "https://www.x.org/releases/individual/driver/xf86-video-vesa-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/driver/xf86-video-vesa.git"
use_git = false
stage = 8

[packages.xinit]
version = "1.4.4"
version_check = "xorg:app/xinit"
description = "X server initialization"
url = "https://www.x.org/releases/individual/app/xinit-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/app/xinit.git"
use_git = false
stage = 8

[packages.xterm]
version = "406"
version_check = "url:https://invisible-island.net/xterm/xterm.log.html|xterm-([0-9]+)"
description = "Standard X terminal emulator"
url = "https://invisible-mirror.net/archives/xterm/xterm-${version}.tgz"
git_url = "https://github.com/ThomasDickey/xterm-snapshots.git"
use_git = false
stage = 8

[packages.xf86-input-evdev]
version = "2.11.0"
version_check = "xorg:driver/xf86-input-evdev"
description = "Xorg evdev input driver"
url = "https://www.x.org/releases/individual/driver/xf86-input-evdev-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/driver/xf86-input-evdev.git"
use_git = false
stage = 8

[packages.eudev]
version = "3.2.14"
version_check = "github:eudev-project/eudev"
description = "Device manager for Linux (udev fork)"
url = "https://github.com/eudev-project/eudev/releases/download/v${version}/eudev-${version}.tar.gz"
git_url = "https://github.com/eudev-project/eudev.git"
use_git = false
stage = 8

[packages.libICE]
version = "1.1.2"
version_check = "xorg:lib/libICE"
description = "X11 Inter-Client Exchange library"
url = "https://www.x.org/releases/individual/lib/libICE-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libice.git"
use_git = false
stage = 8

[packages.libSM]
version = "1.2.6"
version_check = "xorg:lib/libSM"
description = "X11 Session Management library"
url = "https://www.x.org/releases/individual/lib/libSM-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libsm.git"
use_git = false
stage = 8

[packages.iceauth]
version = "1.0.10"
version_check = "xorg:app/iceauth"
description = "ICE authority file utility"
url = "https://www.x.org/releases/individual/app/iceauth-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/app/iceauth.git"
use_git = false
stage = 8

[packages.libxkbfile]
version = "1.1.3"
version_check = "xorg:lib/libxkbfile"
description = "XKB file handling library"
url = "https://www.x.org/releases/individual/lib/libxkbfile-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxkbfile.git"
use_git = false
stage = 8

[packages.libxshmfence]
version = "1.3.3"
version_check = "xorg:lib/libxshmfence"
description = "X shared memory fence library"
url = "https://www.x.org/releases/individual/lib/libxshmfence-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxshmfence.git"
use_git = false
stage = 8

[packages.xkbcomp]
version = "1.5.0"
version_check = "xorg:app/xkbcomp"
description = "XKB keyboard compiler"
url = "https://www.x.org/releases/individual/app/xkbcomp-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/app/xkbcomp.git"
use_git = false
stage = 8

[packages.libfontenc]
version = "1.1.8"
version_check = "xorg:lib/libfontenc"
description = "X font encoding library"
url = "https://www.x.org/releases/individual/lib/libfontenc-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libfontenc.git"
use_git = false
stage = 8

[packages.libXfont2]
version = "2.0.7"
version_check = "xorg:lib/libXfont2"
description = "X font handling library"
url = "https://www.x.org/releases/individual/lib/libXfont2-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxfont.git"
use_git = false
stage = 8

[packages.font-util]
version = "1.4.1"
version_check = "xorg:font/font-util"
description = "X font utilities"
url = "https://www.x.org/releases/individual/font/font-util-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/font/util.git"
use_git = false
stage = 8

[packages.libxcvt]
version = "0.1.3"
version_check = "freedesktop:xorg/lib/libxcvt"
description = "VESA CVT modeline generation library"
url = "https://www.x.org/releases/individual/lib/libxcvt-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxcvt.git"
use_git = false
stage = 8

[packages.libpciaccess]
version = "0.18.1"
version_check = "xorg:lib/libpciaccess"
description = "PCI access library"
url = "https://www.x.org/releases/individual/lib/libpciaccess-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libpciaccess.git"
use_git = false
stage = 8

[packages.libXt]
version = "1.3.1"
version_check = "xorg:lib/libXt"
description = "X Toolkit Intrinsics library"
url = "https://www.x.org/releases/individual/lib/libXt-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxt.git"
use_git = false
stage = 8

[packages.libXmu]
version = "1.2.1"
version_check = "xorg:lib/libXmu"
description = "X miscellaneous utility library"
url = "https://www.x.org/releases/individual/lib/libXmu-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxmu.git"
use_git = false
stage = 8

[packages.libXaw]
version = "1.0.16"
version_check = "xorg:lib/libXaw"
description = "X Athena Widgets library"
url = "https://www.x.org/releases/individual/lib/libXaw-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxaw.git"
use_git = false
stage = 8

[packages.libXpm]
version = "3.5.17"
version_check = "xorg:lib/libXpm"
description = "X Pixmap library"
url = "https://www.x.org/releases/individual/lib/libXpm-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xorg/lib/libxpm.git"
use_git = false
stage = 8

[packages.hwdata]
version = "0.403"
version_check = "github:vcrhonek/hwdata"
description = "Hardware identification databases"
url = "https://github.com/vcrhonek/hwdata/archive/v${version}/hwdata-${version}.tar.gz"
git_url = "https://github.com/vcrhonek/hwdata.git"
use_git = false
stage = 8

[packages.xkeyboard-config]
version = "2.46"
version_check = "xorg:data/xkeyboard-config"
description = "X keyboard configuration database"
url = "https://www.x.org/releases/individual/data/xkeyboard-config/xkeyboard-config-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/xkeyboard-config/xkeyboard-config.git"
use_git = false
stage = 8

# =============================================================================
# STAGE 9: GTK and Desktop Libraries
# =============================================================================

[packages.glib]
version = "2.84.0"
version_check = "gnome:glib"
description = "GLib core library"
url = "https://download.gnome.org/sources/glib/2.84/glib-${version}.tar.xz"
git_url = "https://gitlab.gnome.org/GNOME/glib.git"
use_git = false
stage = 9
build_system = "meson"
meson_flags = "-Dman-pages=disabled -Ddtrace=disabled -Dsystemtap=disabled -Dgtk_doc=false"
provides = ["/usr/lib/libglib-2.0.so"]

[packages.atk]
version = "2.38.0"
version_check = "gnome:atk"
description = "Accessibility toolkit"
url = "https://download.gnome.org/sources/atk/2.38/atk-${version}.tar.xz"
git_url = "https://gitlab.gnome.org/GNOME/atk.git"
use_git = false
stage = 9

[packages.pango]
version = "1.56.0"
version_check = "gnome:pango"
description = "Text layout and rendering library"
url = "https://download.gnome.org/sources/pango/1.56/pango-${version}.tar.xz"
git_url = "https://gitlab.gnome.org/GNOME/pango.git"
use_git = false
stage = 9
build_system = "meson"
provides = ["/usr/lib/libpango-1.0.so"]

[packages.cairo]
version = "1.18.4"
version_check = "freedesktop:cairo/cairo"
description = "2D graphics library"
url = "https://cairographics.org/releases/cairo-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/cairo/cairo.git"
use_git = false
stage = 9
build_system = "meson"
meson_flags = "-Dgtk_doc=false -Dtests=disabled"
provides = ["/usr/lib/libcairo.so"]

[packages.gdk-pixbuf]
version = "2.42.12"
version_check = "gnome:gdk-pixbuf"
description = "Image loading library"
url = "https://download.gnome.org/sources/gdk-pixbuf/2.42/gdk-pixbuf-${version}.tar.xz"
git_url = "https://gitlab.gnome.org/GNOME/gdk-pixbuf.git"
use_git = false
stage = 9
build_system = "meson"
meson_flags = "-Dman=false -Dgtk_doc=false"
provides = ["/usr/lib/libgdk_pixbuf-2.0.so"]

[packages.harfbuzz]
version = "12.3.1"
version_check = "github:harfbuzz/harfbuzz"
description = "Text shaping library"
url = "https://github.com/harfbuzz/harfbuzz/releases/download/${version}/harfbuzz-${version}.tar.xz"
git_url = "https://github.com/harfbuzz/harfbuzz.git"
use_git = false
stage = 9

[packages.fribidi]
version = "1.0.16"
version_check = "github:fribidi/fribidi"
description = "Unicode bidirectional algorithm library"
url = "https://github.com/fribidi/fribidi/releases/download/v${version}/fribidi-${version}.tar.xz"
git_url = "https://github.com/fribidi/fribidi.git"
use_git = false
stage = 9

[packages.gtk3]
version = "3.24.43"
version_check = "gnome:gtk"
description = "GTK+ 3 toolkit"
url = "https://download.gnome.org/sources/gtk+/3.24/gtk+-${version}.tar.xz"
git_url = "https://gitlab.gnome.org/GNOME/gtk.git"
use_git = false
stage = 9
build_system = "meson"
meson_flags = "-Dman=false -Dgtk_doc=false -Dintrospection=false -Ddemos=false -Dexamples=false -Dtests=false"
provides = ["/usr/lib/libgtk-3.so"]

[packages.dbus]
version = "1.14.10"
version_check = "freedesktop:dbus/dbus"
description = "Message bus system"
url = "https://dbus.freedesktop.org/releases/dbus/dbus-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/dbus/dbus.git"
use_git = false
stage = 9

[packages.polkit]
version = "127"
version_check = "url:https://github.com/polkit-org/polkit/tags|/releases/tag/([0-9]+)"
description = "Authorization framework"
url = "https://github.com/polkit-org/polkit/archive/${version}/polkit-${version}.tar.gz"
git_url = "https://github.com/polkit-org/polkit.git"
use_git = false
stage = 9

[packages.libxfce4util]
version = "4.20.1"
version_check = "xfce:xfce/libxfce4util"
description = "Xfce utility library"
url = "https://archive.xfce.org/src/xfce/libxfce4util/4.20/libxfce4util-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/libxfce4util.git"
use_git = false
stage = 9

[packages.xfconf]
version = "4.20.0"
version_check = "xfce:xfce/xfconf"
description = "Xfce configuration system"
url = "https://archive.xfce.org/src/xfce/xfconf/4.20/xfconf-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfconf.git"
use_git = false
stage = 9

[packages.libxfce4ui]
version = "4.20.1"
version_check = "xfce:xfce/libxfce4ui"
description = "Xfce UI library"
url = "https://archive.xfce.org/src/xfce/libxfce4ui/4.20/libxfce4ui-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/libxfce4ui.git"
use_git = false
stage = 9

[packages.xfce4-dev-tools]
version = "4.20.0"
version_check = "xfce:xfce/xfce4-dev-tools"
description = "Xfce development tools"
url = "https://archive.xfce.org/src/xfce/xfce4-dev-tools/4.20/xfce4-dev-tools-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfce4-dev-tools.git"
use_git = false
stage = 9

[packages.libxfce4windowing]
version = "4.20.4"
version_check = "xfce:xfce/libxfce4windowing"
description = "Xfce windowing library"
url = "https://archive.xfce.org/src/xfce/libxfce4windowing/4.20/libxfce4windowing-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/libxfce4windowing.git"
use_git = false
stage = 9

# =============================================================================
# STAGE 10: XFCE Desktop
# =============================================================================

[packages.exo]
version = "4.20.0"
version_check = "xfce:xfce/exo"
description = "Xfce extension library"
url = "https://archive.xfce.org/src/xfce/exo/4.20/exo-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/exo.git"
use_git = false
stage = 10

[packages.garcon]
version = "4.20.0"
version_check = "xfce:xfce/garcon"
description = "Xfce menu library"
url = "https://archive.xfce.org/src/xfce/garcon/4.20/garcon-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/garcon.git"
use_git = false
stage = 10

[packages.xfce4-panel]
version = "4.20.4"
version_check = "xfce:xfce/xfce4-panel"
description = "Xfce panel"
url = "https://archive.xfce.org/src/xfce/xfce4-panel/4.20/xfce4-panel-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfce4-panel.git"
use_git = false
stage = 10

[packages.thunar]
version = "4.20.2"
version_check = "xfce:xfce/thunar"
description = "Xfce file manager"
url = "https://archive.xfce.org/src/xfce/thunar/4.20/thunar-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/thunar.git"
use_git = false
stage = 10

[packages.xfce4-settings]
version = "4.20.3"
version_check = "xfce:xfce/xfce4-settings"
description = "Xfce settings manager"
url = "https://archive.xfce.org/src/xfce/xfce4-settings/4.20/xfce4-settings-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfce4-settings.git"
use_git = false
stage = 10

[packages.xfce4-session]
version = "4.20.2"
version_check = "xfce:xfce/xfce4-session"
description = "Xfce session manager"
url = "https://archive.xfce.org/src/xfce/xfce4-session/4.20/xfce4-session-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfce4-session.git"
use_git = false
stage = 10

[packages.xfwm4]
version = "4.20.0"
version_check = "xfce:xfce/xfwm4"
description = "Xfce window manager"
url = "https://archive.xfce.org/src/xfce/xfwm4/4.20/xfwm4-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfwm4.git"
use_git = false
stage = 10

[packages.xfdesktop]
version = "4.20.1"
version_check = "xfce:xfce/xfdesktop"
description = "Xfce desktop manager"
url = "https://archive.xfce.org/src/xfce/xfdesktop/4.20/xfdesktop-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfdesktop.git"
use_git = false
stage = 10

[packages.xfce4-appfinder]
version = "4.20.0"
version_check = "xfce:xfce/xfce4-appfinder"
description = "Xfce application finder"
url = "https://archive.xfce.org/src/xfce/xfce4-appfinder/4.20/xfce4-appfinder-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/xfce/xfce4-appfinder.git"
use_git = false
stage = 10

[packages.xfce4-terminal]
version = "1.1.5"
version_check = "xfce:apps/xfce4-terminal"
description = "Xfce terminal emulator"
url = "https://archive.xfce.org/src/apps/xfce4-terminal/1.1/xfce4-terminal-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/apps/xfce4-terminal.git"
use_git = false
stage = 10

# =============================================================================
# STAGE 11: Applications
# =============================================================================

[packages.vim]
version = "9.1.2103"
version_check = "url:https://github.com/vim/vim/tags|v([0-9]+\.[0-9]+\.[0-9]+)"
description = "Vi IMproved text editor"
url = "https://github.com/vim/vim/archive/v${version}/vim-${version}.tar.gz"
git_url = "https://github.com/vim/vim.git"
use_git = false
stage = 11

[packages.firefox]
version = "147.0.1"
version_check = "url:https://archive.mozilla.org/pub/firefox/releases/|([0-9]+\.[0-9]+\.?[0-9]*)/linux"
description = "Mozilla Firefox web browser"
url = "https://archive.mozilla.org/pub/firefox/releases/${version}/source/firefox-${version}.source.tar.xz"
git_url = ""
use_git = false
stage = 11
# Note: Firefox is complex to build, consider using prebuilt binary

[packages.alsa-lib]
version = "1.2.15"
version_check = "alsa:lib"
description = "ALSA sound library"
url = "https://www.alsa-project.org/files/pub/lib/alsa-lib-${version}.tar.bz2"
git_url = "https://github.com/alsa-project/alsa-lib.git"
use_git = false
stage = 11

[packages.alsa-utils]
version = "1.2.15"
version_check = "alsa:utils"
description = "ALSA sound utilities"
url = "https://www.alsa-project.org/files/pub/utils/alsa-utils-${version}.tar.bz2"
git_url = "https://github.com/alsa-project/alsa-utils.git"
use_git = false
stage = 11

[packages.pulseaudio]
version = "17.0"
version_check = "freedesktop:pulseaudio/pulseaudio"
description = "Sound server"
url = "https://www.freedesktop.org/software/pulseaudio/releases/pulseaudio-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/pulseaudio/pulseaudio.git"
use_git = false
stage = 11

[packages.xfce4-pulseaudio-plugin]
version = "0.4.8"
version_check = "xfce:apps/xfce4-pulseaudio-plugin"
description = "XFCE panel plugin for PulseAudio"
url = "https://archive.xfce.org/src/panel-plugins/xfce4-pulseaudio-plugin/0.4/xfce4-pulseaudio-plugin-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/panel-plugins/xfce4-pulseaudio-plugin.git"
use_git = false
stage = 11
repology = "xfce4-pulseaudio-plugin"

[packages.pavucontrol]
version = "6.0"
version_check = "freedesktop:pulseaudio/pavucontrol"
description = "PulseAudio Volume Control"
url = "https://www.freedesktop.org/software/pulseaudio/pavucontrol/pavucontrol-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/pulseaudio/pavucontrol.git"
use_git = false
stage = 11
repology = "pavucontrol"

[packages.gedit]
version = "47.0"
version_check = "github:GNOME/gedit"
description = "GNOME text editor"
url = "https://download.gnome.org/sources/gedit/47/gedit-${version}.tar.xz"
git_url = "https://gitlab.gnome.org/GNOME/gedit.git"
use_git = false
stage = 11
repology = "gedit"

[packages.claws-mail]
version = "4.3.1"
version_check = "url:https://www.claws-mail.org/releases.php|([0-9]+\.[0-9]+\.[0-9]+)"
description = "Lightweight email client"
url = "https://www.claws-mail.org/releases/claws-mail-${version}.tar.xz"
git_url = "https://git.claws-mail.org/readonly/claws.git"
use_git = false
stage = 11
repology = "claws-mail"

[packages.chicago95]
version = "3.0.1"
version_check = "github:grassmunk/Chicago95"
description = "Chicago95 XFCE theme (Windows 95 style)"
url = "https://github.com/grassmunk/Chicago95/archive/refs/tags/v${version}.tar.gz"
git_url = "https://github.com/grassmunk/Chicago95.git"
use_git = false
stage = 11
# Includes GTK theme, icons, cursors, sounds, fonts, Plymouth theme

[packages.dejavu-fonts]
version = "2.37"
version_check = "github:dejavu-fonts/dejavu-fonts"
description = "DejaVu TrueType fonts"
url = "https://github.com/dejavu-fonts/dejavu-fonts/releases/download/version_2_37/dejavu-fonts-ttf-${version}.tar.bz2"
git_url = "https://github.com/dejavu-fonts/dejavu-fonts.git"
use_git = false
stage = 11

[packages.liberation-fonts]
version = "2.1.5"
version_check = "github:liberationfonts/liberation-fonts"
description = "Liberation fonts (metric-compatible with Arial, Times, Courier)"
url = "https://github.com/liberationfonts/liberation-fonts/files/7261482/liberation-fonts-ttf-${version}.tar.gz"
git_url = "https://github.com/liberationfonts/liberation-fonts.git"
use_git = false
stage = 11

[packages.vte]
version = "0.78.3"
version_check = "gnome:vte"
description = "Virtual Terminal Emulator widget library"
url = "https://download.gnome.org/sources/vte/0.78/vte-${version}.tar.xz"
git_url = "https://gitlab.gnome.org/GNOME/vte.git"
use_git = false
stage = 10
build_system = "meson"
meson_flags = "-Dvapi=false -Dgtk4=false -Dicu=false -D_systemd=false -Ddocs=false -Dgir=false -Dglade=false"
provides = ["/usr/lib/libvte-2.91.so"]
depends = ["gnutls", "gtk3", "pcre2"]

[packages.xfce4-terminal]
version = "1.1.3"
description = "XFCE terminal emulator"
url = "https://archive.xfce.org/src/apps/xfce4-terminal/1.1/xfce4-terminal-${version}.tar.bz2"
git_url = "https://gitlab.xfce.org/apps/xfce4-terminal.git"
use_git = false
stage = 10
depends = ["vte"]

[packages.nextcloud-client]
version = "4.0.6"
version_check = "github:nextcloud/desktop"
description = "Nextcloud desktop sync client"
url = "https://github.com/nextcloud/desktop/archive/refs/tags/v${version}.tar.gz"
git_url = "https://github.com/nextcloud/desktop.git"
use_git = false
stage = 11
repology = "nextcloud-client"

# =============================================================================
# STAGE 12: GPU Drivers
# =============================================================================

[packages.nvidia-driver]
version = "580.126.09"
version_check = "url:https://www.nvidia.com/Download/processFind.aspx?psid=101&pfid=816&osid=12&lid=1&whql=&lang=en-us&ctk=0|([0-9]+\.[0-9]+\.?[0-9]*)"
description = "NVIDIA proprietary driver"
url = "https://download.nvidia.com/XFree86/Linux-x86_64/${version}/NVIDIA-Linux-x86_64-${version}.run"
git_url = ""
use_git = false
stage = 12
# Note: For real hardware only, use virtio-gpu in VM

[packages.nvidia-driver-latest]
version = "590.48.01"
version_check = "url:https://www.nvidia.com/Download/processFind.aspx?psid=101&pfid=816&osid=12&lid=1&whql=&lang=en-us&ctk=0|([0-9]+\.[0-9]+\.?[0-9]*)"
description = "NVIDIA proprietary driver (new feature branch)"
url = "https://download.nvidia.com/XFree86/Linux-x86_64/${version}/NVIDIA-Linux-x86_64-${version}.run"
git_url = ""
use_git = false
stage = 12
# Note: Newer features but may be less stable

[packages.cuda-toolkit]
version = "12.8.1"
version_check = "url:https://developer.nvidia.com/cuda-downloads|CUDA Toolkit ([0-9]+\\.[0-9]+)"
description = "NVIDIA CUDA Toolkit (nvcc, cuBLAS, cuDNN, etc.)"
url = "https://developer.download.nvidia.com/compute/cuda/${version}/local_installers/cuda_${version}_570.124.06_linux.run"
git_url = ""
use_git = false
stage = 12
depends = ["nvidia-driver"]
# Note: Run with: sh cuda_*.run --silent --toolkit --no-opengl-libs
# Installs to /usr/local/cuda-12.8

# =============================================================================
# VM Support (QEMU/KVM)
# =============================================================================

[packages.virtio-gpu]
version = "0.1"
version_check = "url:https://github.com/nicwn/mtdev/releases|skip"
description = "VirtIO GPU driver (built into kernel)"
url = ""
git_url = ""
use_git = false
stage = 12
# Note: Enable CONFIG_DRM_VIRTIO_GPU in kernel config

[packages.spice-vdagent]
version = "0.23.0"
version_check = "url:https://www.spice-space.org/download/releases/|spice-vdagent-([0-9]+\.[0-9]+\.[0-9]+)\.tar"
description = "Spice agent for VM integration"
url = "https://www.spice-space.org/download/releases/spice-vdagent-${version}.tar.bz2"
git_url = "https://gitlab.freedesktop.org/spice/linux/vd_agent.git"
use_git = false
stage = 12

[packages.qemu-guest-agent]
version = "10.2.0-rc4"
version_check = "github:qemu/qemu"
description = "QEMU guest agent"
url = "https://download.qemu.org/qemu-${version}.tar.xz"
git_url = "https://gitlab.com/qemu-project/qemu.git"
use_git = false
stage = 12

# =============================================================================
# STAGE 13: Gaming (Steam, Proton, Wine)
# =============================================================================

[packages.wine]
version = "10.0"
version_check = "github:wine-mirror/wine"
description = "Windows compatibility layer"
url = "https://dl.winehq.org/wine/source/10.0/wine-${version}.tar.xz"
git_url = "https://gitlab.winehq.org/wine/wine.git"
use_git = false
stage = 13
# Note: Build both 64-bit and 32-bit (multilib)

[packages.dxvk]
version = "2.7.1"
version_check = "github:doitsujin/dxvk"
description = "Vulkan-based D3D9/D3D10/D3D11 translation"
url = "https://github.com/doitsujin/dxvk/releases/download/v${version}/dxvk-${version}.tar.gz"
git_url = "https://github.com/doitsujin/dxvk.git"
use_git = false
stage = 13

[packages.vkd3d-proton]
version = "3.0b"
version_check = "github:HansKristian-Work/vkd3d-proton"
description = "Vulkan-based D3D12 translation"
url = "https://github.com/HansKristian-Work/vkd3d-proton/releases/download/v${version}/vkd3d-proton-${version}.tar.zst"
git_url = "https://github.com/HansKristian-Work/vkd3d-proton.git"
use_git = false
stage = 13

[packages.proton-ge]
version = "GE-Proton10-2"
version_check = "github:GloriousEggroll/proton-ge-custom"
description = "Proton-GE custom Proton build"
url = "https://github.com/GloriousEggroll/proton-ge-custom/releases/download/${version}/${version}.tar.gz"
git_url = "https://github.com/GloriousEggroll/proton-ge-custom.git"
use_git = false
stage = 13
# Install to: ~/.steam/root/compatibilitytools.d/

[packages.steam]
version = "1.0.0.81"
version_check = "url:https://repo.steampowered.com/steam/archive/stable/|steam_([0-9]+\.[0-9]+\.[0-9]+)"
description = "Steam gaming platform"
url = "https://repo.steampowered.com/steam/archive/precise/steam_${version}.tar.gz"
git_url = ""
use_git = false
stage = 13
# Note: Steam is distributed as a binary, requires 32-bit libs

[packages.gamemode]
version = "1.8.2"
version_check = "github:FeralInteractive/gamemode"
description = "Optimize Linux performance for gaming"
url = "https://github.com/FeralInteractive/gamemode/releases/download/${version}/gamemode-${version}.tar.xz"
git_url = "https://github.com/FeralInteractive/gamemode.git"
use_git = false
stage = 13

[packages.mangohud]
version = "0.8.1"
version_check = "github:flightlessmango/MangoHud"
description = "Vulkan/OpenGL overlay for monitoring"
url = "https://github.com/flightlessmango/MangoHud/archive/refs/tags/v${version}.tar.gz"
git_url = "https://github.com/flightlessmango/MangoHud.git"
use_git = false
stage = 13

[packages.gamescope]
version = "3.16.19"
version_check = "github:ValveSoftware/gamescope"
description = "SteamOS session compositing window manager"
url = "https://github.com/ValveSoftware/gamescope/archive/refs/tags/${version}.tar.gz"
git_url = "https://github.com/ValveSoftware/gamescope.git"
use_git = false
stage = 13

[packages.vulkan-loader]
version = "1.4.339"
version_check = "github:KhronosGroup/Vulkan-Loader"
description = "Vulkan ICD loader"
url = "https://github.com/KhronosGroup/Vulkan-Loader/archive/v${version}/Vulkan-Loader-${version}.tar.gz"
git_url = "https://github.com/KhronosGroup/Vulkan-Loader.git"
use_git = false
stage = 13

[packages.vulkan-headers]
version = "1.4.339"
version_check = "url:https://github.com/KhronosGroup/Vulkan-Headers/tags|v([0-9]+\.[0-9]+\.[0-9]+)"
description = "Vulkan header files"
url = "https://github.com/KhronosGroup/Vulkan-Headers/archive/v${version}/Vulkan-Headers-${version}.tar.gz"
git_url = "https://github.com/KhronosGroup/Vulkan-Headers.git"
use_git = false
stage = 13

[packages.spirv-headers]
version = "1.4.335"
version_check = "url:https://github.com/KhronosGroup/SPIRV-Headers/tags|vulkan-sdk-([0-9]+\.[0-9]+\.[0-9]+)"
description = "SPIR-V headers"
url = "https://github.com/KhronosGroup/SPIRV-Headers/archive/vulkan-sdk-${version}/SPIRV-Headers-${version}.tar.gz"
git_url = "https://github.com/KhronosGroup/SPIRV-Headers.git"
use_git = false
stage = 13

[packages.spirv-tools]
version = "vulkan-sdk-1.4.335.0"
version_check = "github:KhronosGroup/SPIRV-Tools"
description = "SPIR-V tools"
url = "https://github.com/KhronosGroup/SPIRV-Tools/archive/refs/tags/${version}.tar.gz"
git_url = "https://github.com/KhronosGroup/SPIRV-Tools.git"
use_git = false
stage = 13

[packages.glslang]
version = "16.1.0"
version_check = "github:KhronosGroup/glslang"
description = "Khronos GLSL/HLSL to SPIR-V compiler"
url = "https://github.com/KhronosGroup/glslang/archive/${version}/glslang-${version}.tar.gz"
git_url = "https://github.com/KhronosGroup/glslang.git"
use_git = false
stage = 13

# =============================================================================
# 32-bit Libraries (required for Steam/Wine)
# =============================================================================

[packages.lib32-glibc]
version = "2.42"
version_check = "gnu:glibc"
description = "GNU C Library (32-bit)"
url = "https://ftpmirror.gnu.org/gnu/glibc/glibc-${version}.tar.xz"
git_url = ""
use_git = false
stage = 13
# Note: Build with --host=i686-pc-linux-gnu

[packages.lib32-mesa]
version = "24.3.4"
version_check = "freedesktop:mesa/mesa"
description = "OpenGL implementation (32-bit)"
url = "https://mesa.freedesktop.org/archive/mesa-${version}.tar.xz"
git_url = ""
use_git = false
stage = 13

[packages.lib32-vulkan-loader]
version = "1.4.339"
version_check = "github:KhronosGroup/Vulkan-Loader"
description = "Vulkan ICD loader (32-bit)"
url = "https://github.com/KhronosGroup/Vulkan-Loader/archive/v${version}/Vulkan-Loader-${version}.tar.gz"
git_url = ""
use_git = false
stage = 13

# =============================================================================
# STAGE 14: Development Tools
# =============================================================================

[packages.git]
version = "2.48.1"
version_check = "github:git/git"
description = "Distributed version control system"
url = "https://www.kernel.org/pub/software/scm/git/git-${version}.tar.xz"
git_url = "https://github.com/git/git.git"
use_git = false
stage = 14

[packages.llvm]
version = "19.1.7"
version_check = "url:https://github.com/llvm/llvm-project/tags|llvmorg-([0-9]+\.[0-9]+\.[0-9]+)"
description = "LLVM compiler infrastructure"
url = "https://github.com/llvm/llvm-project/releases/download/llvmorg-${version}/llvm-project-${version}.src.tar.xz"
git_url = "https://github.com/llvm/llvm-project.git"
use_git = false
stage = 14
# PGO: LLVM benefits ~15-20% from PGO (compile times decrease significantly)
# Stage 1: Build with instrumentation, Stage 2: Generate profiles, Stage 3: Build optimized
# Includes: clang, clang++, flang-new (with MLIR), lld, lldb, clang-tools-extra, compiler-rt
build_commands = [
    "mkdir -p build-stage1 && cd build-stage1 && cmake -G Ninja ../llvm -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS='clang;lld' -DLLVM_TARGETS_TO_BUILD='X86' -DCMAKE_INSTALL_PREFIX=/usr -DLLVM_BUILD_INSTRUMENTED=IR -DLLVM_BUILD_RUNTIME=No -DLLVM_INCLUDE_TESTS=OFF",
    "cd build-stage1 && ninja clang lld",
    "mkdir -p profiles && cd build-stage1 && LLVM_PROFILE_FILE=$(pwd)/../profiles/profile-%p.profraw bin/clang -O2 -c ../clang/lib/Sema/*.cpp 2>/dev/null || true",
    "build-stage1/bin/llvm-profdata merge -output=profdata.prof profiles/*.profraw",
    "mkdir -p build-pgo && cd build-pgo && cmake -G Ninja ../llvm -DCMAKE_BUILD_TYPE=Release -DLLVM_ENABLE_PROJECTS='clang;lld;clang-tools-extra;compiler-rt;mlir;flang;lldb;polly' -DLLVM_ENABLE_RUNTIMES='libcxx;libcxxabi;libunwind' -DLLVM_TARGETS_TO_BUILD='X86;NVPTX;AMDGPU' -DCMAKE_INSTALL_PREFIX=/usr -DLLVM_PROFDATA_FILE=$(pwd)/../profdata.prof -DLLVM_ENABLE_LTO=Thin -DLLVM_PARALLEL_LINK_JOBS=2 -DFLANG_ENABLE_WERROR=OFF -DMLIR_ENABLE_BINDINGS_PYTHON=ON -DLLVM_INSTALL_UTILS=ON",
    "cd build-pgo && ninja",
    "cd build-pgo && DESTDIR=${PKG} ninja install"
]

# [packages.flang] - Now built as part of [packages.llvm] with full MLIR support
# Flang requires MLIR which is included in the unified LLVM build above
# This provides: flang-new (Fortran compiler), mlir-opt, mlir-translate, etc.

[packages.vscode]
version = "1.108.1"
version_check = "github:microsoft/vscode"
description = "Visual Studio Code editor"
url = "https://update.code.visualstudio.com/${version}/linux-x64/stable"
git_url = ""
use_git = false
stage = 14
# Note: Binary distribution, extract to /opt/vscode

[packages.vscode-source]
version = "1.108.1"
version_check = "github:microsoft/vscode"
description = "Visual Studio Code (source build)"
url = "https://github.com/microsoft/vscode/archive/refs/tags/${version}.tar.gz"
git_url = "https://github.com/microsoft/vscode.git"
use_git = false
stage = 14
# Note: Requires Node.js, Yarn, Electron

[packages.nodejs]
version = "25.4.0"
version_check = "github:nodejs/node"
description = "JavaScript runtime"
url = "https://nodejs.org/dist/v${version}/node-v${version}.tar.xz"
git_url = "https://github.com/nodejs/node.git"
use_git = false
stage = 14

# =============================================================================
# STAGE 15: HPC Compilers
# =============================================================================

[packages.nvhpc]
version = "100.630"
version_check = "url:https://developer.nvidia.com/hpc-sdk-downloads|([0-9]+\.[0-9]+)"
description = "NVIDIA HPC SDK (nvfortran, nvc, nvc++)"
# Manual download required from NVIDIA developer site
url = ""
git_url = ""
use_git = false
stage = 15
# Note: Binary distribution, install to /opt/nvidia/hpc_sdk
# Includes: nvfortran, nvc, nvc++, CUDA, cuBLAS, cuFFT, nvcc

[packages.intel-oneapi-hpc]
version = "2025.3"
version_check = "url:https://www.intel.com/content/www/us/en/developer/tools/oneapi/hpc-toolkit-download.html|([0-9]+\.[0-9]+)"
description = "Intel oneAPI HPC Toolkit (ifort, ifx, icc, icx)"
# Manual download required from Intel developer site (registration needed)
url = ""
git_url = ""
use_git = false
stage = 15
# Note: Binary installer, run with --silent --eula accept
# Includes: ifx (new Fortran), ifort (classic), icx, icc, MKL, MPI

[packages.intel-oneapi-base]
version = "2025.3"
version_check = "url:https://www.intel.com/content/www/us/en/developer/tools/oneapi/base-toolkit-download.html|([0-9]+\.[0-9]+)"
description = "Intel oneAPI Base Toolkit"
# Manual download required from Intel developer site (registration needed)
url = ""
git_url = ""
use_git = false
stage = 15
# Note: Required for MKL, TBB, DPC++

# =============================================================================
# STAGE 16: Streaming (Moonlight/Sunshine)
# =============================================================================

[packages.sunshine]
version = "2026.122.133140"
version_check = "github:LizardByte/Sunshine"
description = "Self-hosted game streaming host"
url = "https://github.com/LizardByte/Sunshine/archive/refs/tags/v${version}.tar.gz"
git_url = "https://github.com/LizardByte/Sunshine.git"
use_git = false
stage = 16
# Host: Run on your PC to stream games

[packages.moonlight]
version = "6.1.0"
version_check = "github:moonlight-stream/moonlight-qt"
description = "Open source game streaming client"
url = "https://github.com/moonlight-stream/moonlight-qt/releases/download/v${version}/MoonlightSrc-${version}.tar.gz"
git_url = "https://github.com/moonlight-stream/moonlight-qt.git"
use_git = false
stage = 16
# Client: Run on TV/another device to receive stream

[packages.moonlight-embedded]
version = "2.7.1"
version_check = "github:moonlight-stream/moonlight-embedded"
description = "Moonlight for embedded/ARM devices"
url = "https://github.com/moonlight-stream/moonlight-embedded/releases/download/v${version}/moonlight-embedded-${version}.tar.xz"
git_url = "https://github.com/moonlight-stream/moonlight-embedded.git"
use_git = false
stage = 16
# For Raspberry Pi, etc.

# Dependencies for Sunshine
[packages.libva]
version = "2.23.0"
version_check = "github:intel/libva"
description = "VA-API video acceleration"
url = "https://github.com/intel/libva/releases/download/${version}/libva-${version}.tar.bz2"
git_url = "https://github.com/intel/libva.git"
use_git = false
stage = 16

[packages.ffmpeg]
version = "8.0.1"
version_check = "url:https://github.com/FFmpeg/FFmpeg/tags|n([0-9]+\.[0-9]+\.?[0-9]*)"
description = "Complete multimedia framework"
url = "https://ffmpeg.org/releases/ffmpeg-${version}.tar.xz"
git_url = "https://git.ffmpeg.org/ffmpeg.git"
use_git = false
stage = 16
# Build with: --enable-nvenc --enable-cuda --enable-vaapi

[packages.x264]
version = "stable"
version_check = "url:https://code.videolan.org/videolan/x264/-/tags|stable"
description = "H.264 video encoder"
url = "https://code.videolan.org/videolan/x264/-/archive/stable/x264-stable.tar.bz2"
git_url = "https://code.videolan.org/videolan/x264.git"
use_git = false
stage = 16

[packages.x265]
version = "4.1"
version_check = "url:https://bitbucket.org/multicoreware/x265_git/downloads/|x265_([0-9]+\.[0-9]+)\.tar"
description = "H.265/HEVC video encoder"
url = "https://bitbucket.org/multicoreware/x265_git/downloads/x265_${version}.tar.gz"
git_url = "https://bitbucket.org/multicoreware/x265_git.git"
use_git = false
stage = 16

[packages.opus]
version = "1.6.1"
version_check = "github:xiph/opus"
description = "Audio codec for streaming"
url = "https://downloads.xiph.org/releases/opus/opus-${version}.tar.gz"
git_url = "https://gitlab.xiph.org/xiph/opus.git"
use_git = false
stage = 16

[packages.libavif]
version = "1.3.0"
version_check = "github:AOMediaCodec/libavif"
description = "AVIF image format library"
url = "https://github.com/AOMediaCodec/libavif/archive/v${version}/libavif-${version}.tar.gz"
git_url = "https://github.com/AOMediaCodec/libavif.git"
use_git = false
stage = 16

# =============================================================================
# STAGE 17: Document Processing (LaTeX, Pandoc)
# =============================================================================

[packages.texlive]
version = "2025"
version_check = "url:https://tug.org/texlive/|TeX Live ([0-9]{4})"
description = "TeX Live LaTeX distribution"
url = "https://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz"
git_url = ""
use_git = false
stage = 17
# Note: Run install-tl script, or use texlive ISO for offline install
# Full install is ~7GB, use schemes for smaller installs

[packages.texlive-iso]
version = "2025"
version_check = "url:https://tug.org/texlive/|TeX Live ([0-9]{4})"
description = "TeX Live ISO image (full offline)"
url = "https://mirror.ctan.org/systems/texlive/Images/texlive${version}.iso"
git_url = ""
use_git = false
stage = 17
# Alternative: Full ISO for offline installation

[packages.pandoc]
version = "3.8.3"
version_check = "github:jgm/pandoc"
description = "Universal document converter"
url = "https://github.com/jgm/pandoc/releases/download/${version}/pandoc-${version}-linux-amd64.tar.gz"
git_url = "https://github.com/jgm/pandoc.git"
use_git = false
stage = 17
# Note: Binary distribution; source requires Haskell toolchain

[packages.pandoc-source]
version = "3.8.3"
version_check = "github:jgm/pandoc"
description = "Pandoc (source build)"
url = "https://github.com/jgm/pandoc/archive/refs/tags/${version}.tar.gz"
git_url = "https://github.com/jgm/pandoc.git"
use_git = false
stage = 17
# Requires: ghc, cabal-install

[packages.ghc]
version = "9.10.1"
version_check = "github:ghc/ghc"
description = "Glasgow Haskell Compiler"
url = "https://downloads.haskell.org/~ghc/${version}/ghc-${version}-x86_64-deb11-linux.tar.xz"
git_url = ""
use_git = false
stage = 17
# Required for building Pandoc from source

[packages.poppler]
version = "26.01.0"
version_check = "freedesktop:poppler/poppler"
description = "PDF rendering library"
url = "https://poppler.freedesktop.org/poppler-${version}.tar.xz"
git_url = "https://gitlab.freedesktop.org/poppler/poppler.git"
use_git = false
stage = 17

[packages.ghostscript]
version = "10.04.0"
version_check = "url:https://github.com/ArtifexSoftware/ghostpdl-downloads/releases|ghostscript-([0-9]+\.[0-9]+\.[0-9]+)"
description = "PostScript/PDF interpreter"
url = "https://github.com/ArtifexSoftware/ghostpdl-downloads/releases/download/gs10040/ghostscript-${version}.tar.xz"
git_url = ""
use_git = false
stage = 17

# =============================================================================
# STAGE 18: Scientific Computing Languages
# =============================================================================

[packages.julia]
version = "1.11.2"
version_check = "github:JuliaLang/julia"
description = "Julia programming language"
url = "https://julialang-s3.julialang.org/bin/linux/x64/1.11/julia-${version}-linux-x86_64.tar.gz"
git_url = "https://github.com/JuliaLang/julia.git"
use_git = false
stage = 18
# Note: Binary recommended; source build requires many deps

[packages.julia-source]
version = "1.13.0-beta1"
version_check = "github:JuliaLang/julia"
description = "Julia (source build)"
url = "https://github.com/JuliaLang/julia/releases/download/v${version}/julia-${version}.tar.gz"
git_url = "https://github.com/JuliaLang/julia.git"
use_git = false
stage = 18

[packages.r]
version = "4.4.2"
version_check = "url:https://cran.r-project.org/src/base/R-4/|R-([0-9]+\.[0-9]+\.[0-9]+)\.tar"
description = "R statistical computing language"
url = "https://cran.r-project.org/src/base/R-4/R-${version}.tar.gz"
git_url = "https://github.com/wch/r-source.git"
use_git = false
stage = 18

[packages.octave]
version = "10.3.0"
version_check = "gnu:octave"
description = "GNU Octave numerical computing"
url = "https://ftpmirror.gnu.org/gnu/octave/octave-${version}.tar.xz"
git_url = "https://hg.savannah.gnu.org/hgweb/octave"
use_git = false
stage = 18

# =============================================================================
# STAGE 19: Firmware and Hardware Support
# =============================================================================

[packages.linux-firmware]
version = "20260110"
version_check = "url:https://www.kernel.org/pub/linux/kernel/firmware/|linux-firmware-([0-9]+)\.tar"
description = "Linux kernel firmware files"
url = "https://www.kernel.org/pub/linux/kernel/firmware/linux-firmware-${version}.tar.xz"
git_url = "https://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git"
use_git = false
stage = 19
# Includes: Intel Wi-Fi (iwlwifi), AMD GPU, NVIDIA, i915, etc.

[packages.amd-ucode]
version = "20260110"
version_check = "url:https://www.kernel.org/pub/linux/kernel/firmware/|linux-firmware-([0-9]+)\.tar"
description = "AMD CPU microcode (extracted from linux-firmware)"
url = "https://www.kernel.org/pub/linux/kernel/firmware/linux-firmware-${version}.tar.xz"
git_url = ""
use_git = false
stage = 19
# Extract amd-ucode/ directory and create initrd for early loading

[packages.intel-ucode]
version = "20251111"
version_check = "github:intel/Intel-Linux-Processor-Microcode-Data-Files"
description = "Intel CPU microcode"
url = "https://github.com/intel/Intel-Linux-Processor-Microcode-Data-Files/archive/microcode-${version}.tar.gz"
git_url = "https://github.com/intel/Intel-Linux-Processor-Microcode-Data-Files.git"
use_git = false
stage = 19

[packages.sof-firmware]
version = "2025.12.1"
version_check = "github:thesofproject/sof-bin"
description = "Sound Open Firmware"
url = "https://github.com/thesofproject/sof-bin/releases/download/v${version}/sof-bin-${version}.tar.gz"
git_url = "https://github.com/thesofproject/sof-bin.git"
use_git = false
stage = 19
# Required for some Intel audio devices

# =============================================================================
# Hardware-specific drivers for this system (AMD Ryzen 5950X + RTX 5060 Ti)
# =============================================================================

[packages.amdgpu-firmware]
version = "20260110"
version_check = "url:https://www.kernel.org/pub/linux/kernel/firmware/|linux-firmware-([0-9]+)\.tar"
description = "AMD GPU firmware (part of linux-firmware)"
url = "https://www.kernel.org/pub/linux/kernel/firmware/linux-firmware-${version}.tar.xz"
git_url = ""
use_git = false
stage = 19
# For AMD integrated graphics if present

[packages.iwlwifi-firmware]
version = "20260110"
version_check = "url:https://www.kernel.org/pub/linux/kernel/firmware/|linux-firmware-([0-9]+)\.tar"
description = "Intel Wi-Fi 6 AX200/AX201 firmware"
url = "https://www.kernel.org/pub/linux/kernel/firmware/linux-firmware-${version}.tar.xz"
git_url = ""
use_git = false
stage = 19
# Required for Intel Wi-Fi 6 AX200 [8086:2723]

# Bluetooth firmware
[packages.bluez]
version = "5.85"
version_check = "kernelorg:linux/bluetooth|bluez"
description = "Bluetooth protocol stack"
url = "https://www.kernel.org/pub/linux/bluetooth/bluez-${version}.tar.xz"
git_url = "https://github.com/bluez/bluez.git"
use_git = false
stage = 19

[packages.bluez-firmware]
version = "20260110"
version_check = "url:https://www.kernel.org/pub/linux/kernel/firmware/|linux-firmware-([0-9]+)\.tar"
description = "Bluetooth firmware files (part of linux-firmware)"
url = "https://www.kernel.org/pub/linux/kernel/firmware/linux-firmware-${version}.tar.xz"
git_url = ""
use_git = false
stage = 19

# NVMe tools
[packages.nvme-cli]
version = "2.16"
version_check = "github:linux-nvme/nvme-cli"
description = "NVMe management command line interface"
url = "https://github.com/linux-nvme/nvme-cli/archive/v${version}/nvme-cli-${version}.tar.gz"
git_url = "https://github.com/linux-nvme/nvme-cli.git"
use_git = false
stage = 19
# For Samsung NVMe PM9A1/980PRO management

# Software RAID
[packages.mdadm]
version = "4.4"
version_check = "kernelorg:linux/utils/raid/mdadm|mdadm"
description = "Linux Software RAID management"
url = "https://www.kernel.org/pub/linux/utils/raid/mdadm/mdadm-${version}.tar.xz"
git_url = "https://git.kernel.org/pub/scm/utils/mdadm/mdadm.git"
use_git = false
stage = 19
build_commands = [
    "make -j${NPROC} CXFLAGS=\"${CFLAGS}\"",
    "make DESTDIR=${PKG} install"
]
provides = ["/usr/sbin/mdadm", "/usr/sbin/mdmon"]

# Sensors and monitoring
[packages.lm-sensors]
version = "3-6-0"
version_check = "url:https://github.com/lm-sensors/lm-sensors/tags|V([0-9]+-[0-9]+-[0-9]+)"
description = "Hardware monitoring tools"
url = "https://github.com/lm-sensors/lm-sensors/archive/refs/tags/V${version}.tar.gz"
git_url = "https://github.com/lm-sensors/lm-sensors.git"
use_git = false
stage = 19

[packages.zenpower3]
version = "master"
version_check = "github:ocerman/zenpower"
description = "AMD Ryzen CPU power monitoring"
url = "https://github.com/ocerman/zenpower/archive/refs/heads/master.tar.gz"
git_url = "https://github.com/ocerman/zenpower.git"
use_git = false
stage = 19
# Better sensor support for AMD Ryzen 5000 series

# =============================================================================
# STAGE 20: Xorg Shadow Support (for VESA/fbdev drivers)
# =============================================================================

[packages.libshadow]
version = "4.19.2"
version_check = "github:shadow-maint/shadow"
description = "Xorg shadow framebuffer module (built into xorg-server)"
url = ""
git_url = ""
use_git = false
stage = 20
# Note: Shadow support is built into xorg-server, no separate package needed
# Requires xorg-server to be built with shadow support enabled

# For modesetting driver (built into xorg-server >= 1.18)
[packages.xorg-server-modesetting]
version = "21.1.21"
version_check = "xorg:xserver/xorg-server"
description = "Xorg modesetting driver (built-in)"
url = ""
git_url = ""
use_git = false
stage = 20
# Note: modesetting is built into xorg-server, enable in xorg.conf if needed
# Works with virtio-gpu and most modern GPUs via KMS
