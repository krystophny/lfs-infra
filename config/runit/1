#!/bin/sh
# runit stage 1: system initialization
PATH=/sbin:/bin:/usr/sbin:/usr/bin

mount -t proc proc /proc
mount -t sysfs sys /sys
mount -t devtmpfs dev /dev
mkdir -p /dev/pts /dev/shm
mount -t devpts devpts /dev/pts
mount -t tmpfs shm /dev/shm

mount -o remount,rw /

cat /etc/hostname > /proc/sys/kernel/hostname 2>/dev/null

modprobe -a loop 2>/dev/null
(hwclock -s 2>/dev/null &)

mkdir -p /run/lock /run/user
chmod 1777 /run/lock

udevd --daemon 2>/dev/null
udevadm trigger --action=add --subsystem-match=block
udevadm trigger --action=add --subsystem-match=tty

ip link set lo up

touch /etc/runit/stopit
chmod 0 /etc/runit/stopit

exit 0
